# Tech Challenge - P√≥s-Tech SOAT - FIAP - Fase 2

Alunos:

* Andr√© Mattos - RM358905
* Aurelio Thomasi Jr - RM358104
* Leonardo Ramires - RM358190
* Lucas Arruda - RM358628
* Pedro Marins - RM356883

## Evid√™ncias do projeto
- [Link para o reposit√≥rio](https://github.com/leonardoramires/fiap-ia4devs)
- [Link para o v√≠deo do projeto]()

## Como rodar o projeto

1. Clonar o reposit√≥rio
   ```bash
   git clone https://github.com/leonardoramires/fiap-ia4devs.git
   ```
2. Instalar as depend√™ncias
   ```bash
   pip install -r fase2/requirements.txt
   ```
3. Rodar o projeto
   ```bash
   python fase2/main.py
   ```

> **Sobre instala√ß√£o das depend√™ncias**: √â recomend√°vel utilizar o ambiente virtual do Python para instalar as depend√™ncias, utilizando o comando `python -m venv .venv` e depois ativar o ambiente virtual com o comando `source .venv/bin/activate`.

## Defini√ß√£o do Problema
O problema consiste em alocar ordens de servi√ßo (OS) de manuten√ß√£o para operadores de forma otimizada, considerando as habilidades necess√°rias para cada ordem e as habilidades dos operadores dispon√≠veis. 
O problema a ser resolvido √© maximizar a produtividade operacional, assegurando o cumprimento dos prazos estabelecidos, evitar horas extras desnecess√°rias e garantir que as ordens sejam atendidas dentro do prazo estipulado.

## Objetivos
O projeto aborda o desafio cr√≠tico de otimiza√ß√£o na aloca√ß√£o de ordens de servi√ßo (OS) de manuten√ß√£o. Atrav√©s de um algoritmo especializado, o sistema realiza o pareamento preciso entre as compet√™ncias t√©cnicas dos operadores e as exig√™ncias espec√≠ficas de cada ordem.

Alocar ordens de servi√ßo de forma eficiente, maximizando a compatibilidade entre as habilidades dos operadores e as habilidades necess√°rias para as ordens.
Minimizar o n√∫mero de horas extras trabalhadas pelos operadores.
Garantir que as ordens de maior prioridade sejam atendidas dentro do prazo.

## O Projeto
![Fluxograma Gen√©tico do Algoritmo Gen√©tico](assets/fluxograma.jpeg)

*Figura 1: Fluxograma Gen√©rico do Algoritmo Gen√©tico*

Este projeto foi desenvolvido utilizando um algoritmo gen√©tico para otimizar a aloca√ß√£o de ordens de servi√ßo aos operadores. As seguintes informa√ß√µes relevantes sobre as ordens e operadores s√£o utilizadas para a otimiza√ß√£o:

- **Dados das ordens**: Incluem o tempo estimado de execu√ß√£o, habilidades necess√°rias, prioridade, status, e o dia esperado de in√≠cio do atendimento.
- **Dados dos operadores**: Cont√™m as habilidades dispon√≠veis, n√≠vel de qualifica√ß√£o e horas dispon√≠veis.

Abaixo est√£o os pontos essenciais desta solu√ß√£o, com os principais detalhes:

### 1. Reajuste nas Fun√ß√µes de Aptid√£o
- ‚ú® Adi√ß√£o de pesos considerando a prioridade da OS
- üìä Penaliza√ß√£o proporcional por horas extras

### 2. Otimiza√ß√£o do Crossover
- üîÑ Garantia de atribui√ß√£o √∫nica para cada ordem
- üìâ Redu√ß√£o de solu√ß√µes invi√°veis
- üìà Melhoria na qualidade das solu√ß√µes

### 3. Processo de Muta√ß√£o Inteligente
- üß¨ Verifica√ß√£o da qualidade p√≥s-muta√ß√£o
- ‚Ü©Ô∏è Revers√£o autom√°tica de muta√ß√µes prejudiciais

### 4. Sistema de Elitismo
- üèÜ Preserva√ß√£o dos melhores indiv√≠duos (5 melhores)
- üìà Manuten√ß√£o de solu√ß√µes de alta qualidade entre gera√ß√µes

### 5. Gest√£o Populacional
- üîÑ Reinicializa√ß√£o parcial peri√≥dica (metade da popula√ß√£o)
- üéØ Preven√ß√£o de converg√™ncia prematura para uma solu√ß√£o sub√≥tima

### 6. Controle de Qualifica√ß√£o
- ‚úÖ Exig√™ncia m√≠nima de 50% das habilidades necess√°rias
- üö´ Preven√ß√£o de aloca√ß√µes inadequadas

## Detalhamento do Algoritmo Gen√©tico

### 1. Gera√ß√£o da Popula√ß√£o Inicial üå±
A popula√ß√£o inicial consiste em um conjunto de solu√ß√µes (indiv√≠duos) geradas aleatoriamente, onde cada solu√ß√£o representa uma poss√≠vel aloca√ß√£o de ordens de servi√ßo ao longo do per√≠odo de 5 dias.
Tamb√©m existe uma op√ß√£o de gerar a popula√ß√£o inicial com base em uma solu√ß√£o pr√©-definida, que √© a solu√ß√£o encontrada pelo algoritmo gen√©tico da fase 1.

#### Processo de Gera√ß√£o:
- **Distribui√ß√£o Aleat√≥ria**: As ordens s√£o distribu√≠das entre operadores e dias
- **Valida√ß√£o de Habilidades**: Garantia de compatibilidade entre operador e ordem
- **Estrutura**: `{dia: {operador_id: [ordem_ids]}}`

### 2. Processo de Sele√ß√£o üéØ
Utilizamos o m√©todo de torneio para selecionar as solu√ß√µes (pais) que gerar√£o a pr√≥xima gera√ß√£o.

#### Etapas do Torneio:
1. Sele√ß√£o aleat√≥ria de um grupo de solu√ß√µes
2. Avalia√ß√£o da aptid√£o de cada solu√ß√£o
3. Escolha da melhor solu√ß√£o como pai
4. Repeti√ß√£o at√© atingir o n√∫mero necess√°rio de pais

### 3. Processo de Crossover üîÑ
O crossover combina duas solu√ß√µes (pais) para gerar uma nova solu√ß√£o (filho).

#### Metodologia:
1. **Sele√ß√£o do Ponto**: 
   - Escolha aleat√≥ria do ponto de divis√£o
   - Exemplo: Em 5 dias, ponto 2 = dias [1-2] + [3-5]

2. **Combina√ß√£o**:
   - Primeiro segmento do pai 1
   - Segundo segmento do pai 2
   - Garantia de atribui√ß√£o √∫nica para cada ordem

### 4. Processo de Muta√ß√£o üß¨
A muta√ß√£o introduz varia√ß√µes nas solu√ß√µes para manter a diversidade gen√©tica.

#### Procedimento:
1. **Verifica√ß√£o**: Probabilidade de muta√ß√£o por dia
2. **Execu√ß√£o**: 
   - Sele√ß√£o de dois operadores no mesmo dia
   - Troca de ordens entre eles
3. **Valida√ß√£o**: 
   - Avalia√ß√£o pr√© e p√≥s-muta√ß√£o
   - Revers√£o se n√£o houver melhoria

### 5. Fun√ß√£o de Aptid√£o ‚öñÔ∏è
Avalia a qualidade das solu√ß√µes considerando m√∫ltiplos crit√©rios.

#### Crit√©rios de Avalia√ß√£o:
1. **Compatibilidade de Habilidades**:
   - Pontua√ß√£o positiva para matches
   - Penalidades para incompatibilidades

2. **Gest√£o de Prazos**:
   - Verifica√ß√£o de conclus√£o no prazo
   - Penalidades proporcionais a atrasos e prioridades

3. **Controle de Horas**:
   - Monitoramento de horas por operador
   - Penaliza√ß√£o por excesso

### 6. Fluxo do Algoritmo üîÑ
1. **Inicializa√ß√£o**:
   - Gera√ß√£o da popula√ß√£o inicial

2. **Ciclo Evolutivo**:
   - C√°lculo de aptid√£o
   - Sele√ß√£o por torneio
   - Crossover
   - Muta√ß√£o
   - Elitismo
   - Reinicializa√ß√£o parcial peri√≥dica

3. **Finaliza√ß√£o**:
   - Sele√ß√£o da melhor solu√ß√£o
   - Convers√£o para DataFrame

### 7. Relat√≥rio com PyGame üéÆ
![Relat√≥rio com PyGame](assets/relatorio.gif)

*Figura 2: Relat√≥rio com PyGame*

Este relat√≥rio foi gerado utilizando a biblioteca PyGame, que √© uma biblioteca Python para cria√ß√£o de jogos e simula√ß√µes. O relat√≥rio √© respons√°vel por exibir o resultado do algoritmo gen√©tico de forma visual, mostrando a aloca√ß√£o das ordens de servi√ßo aos operadores ao longo do per√≠odo de 5 dias, em formato de um calend√°rio.

## Informa√ß√µes gerais sobre o resultado do algoritmo
A an√°lise dos resultados do algoritmo gen√©tico para aloca√ß√£o de ordens de servi√ßo de manuten√ß√£o revela aspectos importantes sobre sua performance e limita√ß√µes. O algoritmo foi desenvolvido para otimizar a distribui√ß√£o de 100 ordens de servi√ßo entre 15 operadores ao longo de 5 dias, considerando m√∫ltiplas vari√°veis como habilidades t√©cnicas, prioridades e prazos.

### 1. üîÑ Compara√ß√£o com outros algoritmos
Outros algoritmos foram utilizados por ordem de realizar a compara√ß√£o, como o algoritmo guloso, o algoritmo de programa√ß√£o linear e a aloca√ß√£o humana.
Esta compara√ß√£o foi realizada com base no fitness das solu√ß√µes encontradas pelos algoritmos, que √© uma medida da qualidade da solu√ß√£o encontrada. O resultado desta compara√ß√£o pode ser visto na se√ß√£o üìä Estat√≠sticas gerais do algoritmo.

### 2. üìä Estat√≠sticas gerais do algoritmo

#### Informa√ß√µes gerais sobre as ordens:
| M√©trica | Valor |
|---------|-------|
| Total de Ordens | 100 |
| Ordens Alocadas | 85 (85.0%) |
| Ordens N√£o Alocadas | 15 |

O algoritmo conseguiu alocar 85% das ordens de servi√ßo.

#### An√°lise por prioridade:
| Prioridade | Quantidade | Percentual |
|------------|------------|------------|
| Urgente | 20 | 23.5% |
| Alta | 29 | 34.1% |
| M√©dia | 24 | 28.2% |
| Baixa | 12 | 14.1% |

#### Ordens n√£o alocadas:
Neste caso, o algoritmo n√£o conseguiu alocar 15 ordens de servi√ßo.

#### Compara√ß√£o de Fitness entre os algoritmos
| Algoritmo | Fitness |
|-----------|---------|
| Greedy Algorithm | 400.0 |
| Linear Programming | -1005.0 |
| Aloca√ß√£o Humana | 615.0 |
| Genetic Algorithm | 1095.0 |

Como podemos ver, o algoritmo gen√©tico foi o que obteve o melhor resultado, seguido pela aloca√ß√£o humana.

#### Distribui√ß√£o por dia
Resumo das ordens alocadas por dia:

| Dia | Total de Ordens | Horas Alocadas | Urgente | Alta | M√©dia | Baixa |
|-----|----------------|----------------|----------|------|-------|-------|
| 1 | 18 | 80.0h | 17 | 1 | 0 | 0 |
| 2 | 18 | 80.0h | 3 | 14 | 1 | 0 |
| 3 | 16 | 76.0h | 0 | 14 | 2 | 0 |
| 4 | 18 | 80.0h | 0 | 0 | 15 | 3 |
| 5 | 15 | 76.0h | 0 | 0 | 6 | 9 |

### Dados dos operadores
| operator_id | skills | level | shift | hours_per_day |
|------------|--------|-------|-------|---------------|
| op1 | pintura \| el√©trica \| solda | s√™nior | manh√£ | 7 |
| op2 | el√©trica \| pintura \| alvenaria | j√∫nior | manh√£ | 7 |
| op3 | pintura \| el√©trica \| hidr√°ulica | s√™nior | noite | 7 |
| op4 | pintura \| alvenaria \| el√©trica | pleno | tarde | 9 |
| op5 | pintura \| hidr√°ulica | pleno | tarde | 9 |
| op6 | solda \| hidr√°ulica | especialista | tarde | 7 |
| op7 | pintura \| el√©trica \| alvenaria | j√∫nior | tarde | 9 |
| op8 | el√©trica \| pintura \| solda | s√™nior | tarde | 7 |
| op9 | pintura \| solda | j√∫nior | tarde | 8 |
| op10 | solda \| el√©trica \| pintura | pleno | manh√£ | 9 |
| op11 | el√©trica \| alvenaria \| solda | s√™nior | manh√£ | 7 |
| op12 | hidr√°ulica \| alvenaria | s√™nior | noite | 9 |
| op13 | hidr√°ulica \| solda | j√∫nior | tarde | 8 |
| op14 | solda \| el√©trica | especialista | manh√£ | 8 |
| op15 | alvenaria \| el√©trica \| hidr√°ulica | especialista | manh√£ | 9 |

### Dados das ordens
| id_ordem | Servi√ßos | horas_estimadas | prioridade | inicio_esperado | status |
|----------|----------|-----------------|------------|-----------------|---------|
| os1 | el√©trica | 5 | m√©dia | 4 | n√£o_atendida |
| os2 | hidr√°ulica | 8 | alta | 1 | n√£o_atendida |
| os3 | hidr√°ulica \| pintura | 5 | m√©dia | 2 | n√£o_atendida |
| os4 | hidr√°ulica | 7 | baixa | 2 | n√£o_atendida |
| os5 | alvenaria | 2 | alta | 4 | n√£o_atendida |
| os96 | solda \| pintura | 8 | baixa | 5 | n√£o_atendida |
| os97 | solda \| hidr√°ulica | 2 | urgente | 1 | n√£o_atendida |
| os98 | hidr√°ulica | 5 | m√©dia | 5 | n√£o_atendida |
| os99 | el√©trica | 2 | alta | 1 | n√£o_atendida |
| os100 | hidr√°ulica | 3 | m√©dia | 5 | n√£o_atendida |

[100 rows x 6 columns]

### Dados das ordens atribu√≠das aos operdores (shape = (100, 17))
| dia | id_ordem | id_operador | Servi√ßos | compatibilidade_prioridade | hora_extra | total_hora_extra | status |
|-----|----------|-------------|-----------|---------------------------|------------|------------------|---------|
| 4 | os22 | op1 | solda \| pintura | OK | N√£o | -2 | atendida |
| 1 | os36 | op1 | el√©trica | OK | N√£o | -3 | atendida |
| 1 | os49 | op1 | el√©trica | OK | Sim | 2 | atendida |
| 5 | os55 | op1 | pintura \| solda | OK | N√£o | 0 | atendida |
| 2 | os68 | op1 | el√©trica | OK | Sim | 1 | atendida |
| ... | ... | ... | ... | ... | ... | ... | ... |
| 2 | os30 | op9 | hidr√°ulica \| pintura | OK | N√£o | 0 | atendida |
| 1 | os48 | op9 | solda | OK | N√£o | -6 | atendida |
| 3 | os78 | op9 | solda | OK | N√£o | -1 | atendida |
| 1 | os90 | op9 | alvenaria \| solda | NOK | N√£o | -1 | atendida |
| 4 | os96 | op9 | solda \| pintura | OK | N√£o | 0 | atendida |
